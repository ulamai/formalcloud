schema_version: formal-cloud.benchmark/v1
cases:
  - id: terraform_reject_prod_insecure
    target: terraform
    policies: ../../examples/policies.yaml
    plan: ../../examples/terraform-plan.json
    workspace: prod
    expected_decision: reject
    expected_certificate_id: 0c7e4b1fab4c5097373392cf6e14eadfe5d436bf408f389d9214273f72507059

  - id: terraform_accept_prod_secure
    target: terraform
    policies: ../../examples/policies.yaml
    plan: terraform-plan-secure.json
    workspace: prod
    expected_decision: accept
    expected_certificate_id: aa93fdc39339625e74c2e033e0851f9c1ca61d158fc7422f8d357562725c0516

  - id: kubernetes_reject_insecure
    target: kubernetes
    policies: ../../examples/policies.yaml
    manifests:
      - ../../examples/k8s-manifest.yaml
    expected_decision: reject
    expected_certificate_id: cd35cee8c53b1382cbf6c569a2544478113e3370bd0ab754f8ef2be41400bf50

  - id: kubernetes_accept_secure
    target: kubernetes
    policies: ../../examples/policies.yaml
    manifests:
      - k8s-manifest-secure.yaml
    expected_decision: accept
    expected_certificate_id: fecfac4764d3bca55be6f5e1fb364682005f469b1da5ca901e905adcebeb4f22
